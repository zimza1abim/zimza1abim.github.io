---
import { getCollection, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Container from '../../components/container.astro';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug }, props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

const defaultImage = "https://images.unsplash.com/photo-1493612276216-ee3925520721?q=80&w=1000&auto=format&fit=crop";
const imageSrc = entry.data.image?.src || defaultImage;
---

<Layout title={entry.data.title}>
  <Container>
    <article class="max-w-3xl mx-auto mt-10 mb-20">
      
      <div class="text-center mb-12">
        <div class="flex justify-center gap-2 mb-6">
          <span class="bg-rose-50 text-rose-500 text-xs font-bold px-3 py-1 rounded-full tracking-wider uppercase">
            {entry.data.category || "General"}
          </span>
        </div>
        
        <h1 class="text-3xl lg:text-5xl font-bold text-stone-800 mb-6 leading-tight">
          {entry.data.title}
        </h1>
        
        <div class="text-stone-400 text-sm tracking-widest uppercase flex justify-center items-center gap-2">
          <span>{entry.data.author || "Winter"}</span>
          <span>•</span>
          <time>{entry.data.publishDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</time>
        </div>
      </div>

      <div class="rounded-[2rem] overflow-hidden mb-12 shadow-sm aspect-video bg-stone-100">
        <img 
          src={imageSrc} 
          alt={entry.data.title} 
          class="w-full h-full object-cover"
        />
      </div>

      <div class="prose prose-lg prose-stone mx-auto prose-headings:font-bold prose-p:font-light prose-p:leading-8 prose-a:text-rose-500 hover:prose-a:text-rose-600 prose-img:rounded-3xl">
        <Content />
      </div>

      <div class="mt-16 pt-10 border-t border-stone-100 text-center">
        <a href="/blog" class="inline-flex items-center text-stone-400 hover:text-rose-500 transition-colors text-sm font-medium tracking-wide">
          ← Back to Stories
        </a>
      </div>

    </article>
  </Container>
</Layout>